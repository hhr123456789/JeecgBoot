# ğŸš€ å¿«é€Ÿè°ƒè¯•å¯¼å‡ºExcelé—®é¢˜

## ç«‹å³æ‰§è¡Œçš„è°ƒè¯•æ­¥éª¤

### 1. ä½¿ç”¨è°ƒè¯•æ¥å£æ£€æŸ¥ä»ªè¡¨æ•°æ®

æˆ‘å·²ç»æ·»åŠ äº†ä¸€ä¸ªè°ƒè¯•æ¥å£ï¼Œè¯·ç«‹å³è°ƒç”¨ï¼š

```bash
# è°ƒç”¨è°ƒè¯•æ¥å£ï¼ˆè¯·æ ¹æ®å®é™…çš„ä»ªè¡¨IDè°ƒæ•´ï¼‰
GET http://localhost:8080/energy/monitor/debugModuleData?moduleIds=yj0001_1202,yj0001_1203,yj0001_1204,yj0001_1205
```

**æˆ–è€…ä½¿ç”¨curl**ï¼š
```bash
curl "http://localhost:8080/energy/monitor/debugModuleData?moduleIds=yj0001_1202,yj0001_1203,yj0001_1204,yj0001_1205"
```

### 2. åˆ†æè°ƒè¯•ç»“æœ

è°ƒè¯•æ¥å£ä¼šè¿”å›ä»¥ä¸‹å…³é”®ä¿¡æ¯ï¼š

```json
{
    "success": true,
    "result": {
        "moduleNameMap": {
            "yj0001_1202": "1å·æ³¨å¡‘æœº",
            "yj0001_1203": "2å·æ³¨å¡‘æœº"
        },
        "foundModules": 2,
        "requestedModules": 4,
        "influxDataCount": 120,
        "tagnameDataCount": {
            "YJ0001_1202#IA": 60,
            "YJ0001_1203#IA": 60
        },
        "expectedTagnames": [
            "YJ0001_1202#IA",
            "YJ0001_1203#IA",
            "YJ0001_1204#IA",
            "YJ0001_1205#IA"
        ],
        "sampleData": [...]
    }
}
```

### 3. æ ¹æ®è°ƒè¯•ç»“æœåˆ¤æ–­é—®é¢˜

#### æƒ…å†µAï¼šfoundModules < requestedModules
**é—®é¢˜**ï¼šä»ªè¡¨IDä¸æ­£ç¡®
**è§£å†³**ï¼šä½¿ç”¨æ­£ç¡®çš„ä»ªè¡¨ID

#### æƒ…å†µBï¼šinfluxDataCount = 0
**é—®é¢˜**ï¼šInfluxDBä¸­æ²¡æœ‰æ•°æ®
**è§£å†³**ï¼šæ£€æŸ¥æ•°æ®åŒæ­¥æˆ–æ—¶é—´èŒƒå›´

#### æƒ…å†µCï¼štagnameDataCountä¸ºç©ºæˆ–ä¸åŒ¹é…
**é—®é¢˜**ï¼štagnameæ ¼å¼ä¸æ­£ç¡®
**è§£å†³**ï¼šæ£€æŸ¥tagnameæ„å»ºé€»è¾‘

### 4. æŸ¥çœ‹åç«¯æ—¥å¿—

åŒæ—¶æŸ¥çœ‹åç«¯æ—¥å¿—ä¸­çš„è¯¦ç»†ä¿¡æ¯ï¼š

```bash
tail -f logs/jeecg-boot.log | grep -E "(ğŸ“Š|ğŸ”|âŒ)"
```

### 5. ç¡®è®¤æ­£ç¡®çš„ä»ªè¡¨ID

å¦‚æœè°ƒè¯•æ¥å£æ˜¾ç¤ºä»ªè¡¨IDä¸æ­£ç¡®ï¼Œè¯·æ‰§è¡Œä»¥ä¸‹SQLæŸ¥è¯¢ï¼š

```sql
-- æŸ¥è¯¢æ‰€æœ‰æ³¨å¡‘æœºçš„ä»ªè¡¨ID
SELECT module_id, module_name, energy_type, isaction, sys_org_code
FROM tb_module 
WHERE module_name LIKE '%æ³¨å¡‘æœº%' 
AND isaction = 'Y'
ORDER BY module_name;
```

### 6. æµ‹è¯•ä¿®å¤åçš„å¯¼å‡ºåŠŸèƒ½

ä½¿ç”¨æ­£ç¡®çš„ä»ªè¡¨IDé‡æ–°æµ‹è¯•å¯¼å‡ºï¼š

```json
{
    "moduleIds": ["æ­£ç¡®çš„ä»ªè¡¨ID1", "æ­£ç¡®çš„ä»ªè¡¨ID2", "æ­£ç¡®çš„ä»ªè¡¨ID3", "æ­£ç¡®çš„ä»ªè¡¨ID4"],
    "parameters": [1],
    "startTime": "2025-07-23 00:00:00",
    "endTime": "2025-07-23 21:51:21",
    "interval": 1,
    "displayMode": 1,
    "fileName": "æ³¨å¡‘æœºAç›¸ç”µæµæ•°æ®å¯¼å‡º"
}
```

## ğŸ”§ å·²ä¿®å¤çš„é—®é¢˜

1. **å¢å¼ºäº†è°ƒè¯•æ—¥å¿—**ï¼šå¯¼å‡ºè¿‡ç¨‹ä¸­ä¼šæ˜¾ç¤ºè¯¦ç»†çš„è°ƒè¯•ä¿¡æ¯
2. **æ·»åŠ äº†è°ƒè¯•æ¥å£**ï¼šå¯ä»¥å¿«é€Ÿæ£€æŸ¥ä»ªè¡¨IDå’Œæ•°æ®çŠ¶æ€
3. **ç»Ÿä¸€äº†tagnameæ„å»º**ï¼šç¡®ä¿å¯¼å‡ºå’ŒæŸ¥è¯¢ä½¿ç”¨ç›¸åŒçš„é€»è¾‘
4. **æ”¹è¿›äº†é”™è¯¯å¤„ç†**ï¼šæä¾›æ›´è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯

## ğŸ“ å¦‚æœé—®é¢˜ä»ç„¶å­˜åœ¨

è¯·æä¾›ä»¥ä¸‹ä¿¡æ¯ï¼š

1. **è°ƒè¯•æ¥å£çš„è¿”å›ç»“æœ**
2. **åç«¯æ—¥å¿—ä¸­çš„å…³é”®ä¿¡æ¯**
3. **æ•°æ®åº“ä¸­å®é™…çš„ä»ªè¡¨ID**
4. **InfluxDBä¸­æ˜¯å¦æœ‰å¯¹åº”çš„æ•°æ®**

è¿™æ ·æˆ‘å¯ä»¥è¿›ä¸€æ­¥å®šä½å’Œä¿®å¤é—®é¢˜ã€‚

## ğŸ¯ é¢„æœŸç»“æœ

ä¿®å¤åï¼Œå¯¼å‡ºçš„Excelåº”è¯¥ï¼š
- åŒ…å«å®Œæ•´çš„æ—¶é—´èŒƒå›´ï¼ˆ00:00 åˆ° 21:45ï¼‰
- æ˜¾ç¤º4ä¸ªä»ªè¡¨çš„Aç›¸ç”µæµæ•°æ®
- æ¯ä¸ªæ—¶é—´ç‚¹éƒ½æœ‰å¯¹åº”çš„æ•°å€¼ï¼ˆä¸æ˜¯"-"ï¼‰
