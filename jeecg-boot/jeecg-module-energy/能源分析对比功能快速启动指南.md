# èƒ½æºåˆ†æå¯¹æ¯”åŠŸèƒ½å¿«é€Ÿå¯åŠ¨æŒ‡å—

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å¯åŠ¨åº”ç”¨
```bash
# è¿›å…¥é¡¹ç›®ç›®å½•
cd jeecg-boot

# å¯åŠ¨åº”ç”¨
mvn spring-boot:run
# æˆ–è€…
java -jar target/jeecg-boot-3.7.2.jar
```

### 2. éªŒè¯æœåŠ¡çŠ¶æ€
```bash
# å¥åº·æ£€æŸ¥
curl http://localhost:8080/jeecg-boot/energy/analysis/health
```

é¢„æœŸå“åº”ï¼š
```json
{
  "success": true,
  "message": "æ“ä½œæˆåŠŸ",
  "code": 200,
  "result": "èƒ½æºåˆ†ææœåŠ¡è¿è¡Œæ­£å¸¸",
  "timestamp": 1691234567890
}
```

## ğŸ“‹ æ ¸å¿ƒæ¥å£æµ‹è¯•

### 1. è·å–èƒ½æºç±»å‹é…ç½®
```bash
curl -X GET "http://localhost:8080/jeecg-boot/energy/analysis/getEnergyTypes" \
     -H "Accept: application/json"
```

### 2. è·å–æ³¨å¡‘éƒ¨é—¨ä»ªè¡¨åˆ—è¡¨
```bash
curl -X GET "http://localhost:8080/jeecg-boot/energy/analysis/getModulesByDimension?orgCode=A02A02A01&energyType=1" \
     -H "Accept: application/json"
```

### 3. æŸ¥è¯¢1å·æ³¨å¡‘æœºæ—¥å¯¹æ¯”æ•°æ®
```bash
curl -X POST "http://localhost:8080/jeecg-boot/energy/analysis/getCompareData" \
     -H "Content-Type: application/json" \
     -d '{
       "moduleId": "yj0001_1202",
       "timeType": "day",
       "startTime": "2025-07-26", 
       "endTime": "2025-08-02",
       "compareType": "compare"
     }'
```

## ğŸ—‚ï¸ æ•°æ®åº“éªŒè¯

### 1. æ£€æŸ¥ä»ªè¡¨æ•°æ®
```sql
-- æŸ¥çœ‹ä»ªè¡¨åŸºç¡€ä¿¡æ¯
SELECT module_id, module_name, energy_type, sys_org_code 
FROM tb_module 
WHERE isaction = 'Y' 
LIMIT 5;

-- æŸ¥çœ‹ç»´åº¦ä¿¡æ¯
SELECT id, depart_name, org_code, parent_id 
FROM sys_depart 
WHERE org_code IN ('A02A02A01', 'A02A02A04', 'A02A02A05');
```

### 2. æ£€æŸ¥ç»Ÿè®¡æ•°æ®
```sql
-- æŸ¥çœ‹æ—¥ç»Ÿè®¡æ•°æ®
SELECT module_id, dt, energy_count 
FROM tb_ep_equ_energy_daycount 
WHERE module_id = 'yj0001_1202' 
ORDER BY dt DESC 
LIMIT 5;

-- æŸ¥çœ‹æœˆç»Ÿè®¡æ•°æ®
SELECT module_id, dt, energy_count 
FROM tb_ep_equ_energy_monthcount 
WHERE module_id = 'yj0001_1202' 
ORDER BY dt DESC 
LIMIT 5;
```

## ğŸ”§ å¸¸è§é—®é¢˜æ’æŸ¥

### 1. æ¥å£è¿”å›ç©ºæ•°æ®
**å¯èƒ½åŸå› **ï¼š
- ç»´åº¦ç¼–ç ä¸å­˜åœ¨
- ä»ªè¡¨æ•°æ®ä¸ºç©º
- ç»Ÿè®¡æ•°æ®ç¼ºå¤±

**æ’æŸ¥æ­¥éª¤**ï¼š
```sql
-- 1. æ£€æŸ¥ç»´åº¦æ˜¯å¦å­˜åœ¨
SELECT * FROM sys_depart WHERE org_code = 'A02A02A01';

-- 2. æ£€æŸ¥ä»ªè¡¨æ˜¯å¦å…³è”åˆ°ç»´åº¦
SELECT m.*, d.depart_name 
FROM tb_module m 
LEFT JOIN sys_depart d ON m.sys_org_code = d.id 
WHERE d.org_code = 'A02A02A01';

-- 3. æ£€æŸ¥ç»Ÿè®¡æ•°æ®
SELECT COUNT(*) FROM tb_ep_equ_energy_daycount WHERE module_id = 'yj0001_1202';
```

### 2. åŒæ¯”æ•°æ®ä¸ºç©º
**å¯èƒ½åŸå› **ï¼š
- å»å¹´åŒæœŸæ•°æ®ä¸å­˜åœ¨
- æ—¶é—´èŒƒå›´è®¡ç®—é”™è¯¯

**æ’æŸ¥æ­¥éª¤**ï¼š
```sql
-- æ£€æŸ¥å»å¹´åŒæœŸæ•°æ®
SELECT * FROM tb_ep_equ_energy_daycount 
WHERE module_id = 'yj0001_1202' 
AND DATE(dt) BETWEEN '2024-07-26' AND '2024-08-02';
```

### 3. ç»´åº¦æŸ¥è¯¢æ— ç»“æœ
**æ£€æŸ¥æ­¥éª¤**ï¼š
```sql
-- ç¡®è®¤org_codeæ ¼å¼
SELECT org_code, depart_name FROM sys_depart WHERE org_code LIKE 'A02%';

-- ç¡®è®¤ä»ªè¡¨çš„sys_org_codeå­—æ®µ
SELECT DISTINCT sys_org_code FROM tb_module WHERE isaction = 'Y';
```

## ğŸ“Š Swaggeræ–‡æ¡£è®¿é—®

å¯åŠ¨åº”ç”¨åï¼Œè®¿é—®Swaggeræ–‡æ¡£ï¼š
```
http://localhost:8080/jeecg-boot/doc.html
```

åœ¨æ–‡æ¡£ä¸­æ‰¾åˆ° "èƒ½æºåˆ†æå¯¹æ¯”" æ¨¡å—ï¼Œå¯ä»¥ç›´æ¥åœ¨çº¿æµ‹è¯•æ¥å£ã€‚

## ğŸ¯ å‰ç«¯é›†æˆç¤ºä¾‹

### 1. è·å–ä»ªè¡¨åˆ—è¡¨
```javascript
// è·å–æ³¨å¡‘éƒ¨é—¨çš„ç”µåŠ›ä»ªè¡¨
const getModules = async (orgCode) => {
  const response = await fetch(
    `/jeecg-boot/energy/analysis/getModulesByDimension?orgCode=${orgCode}&energyType=1`,
    {
      method: 'GET',
      headers: {
        'Accept': 'application/json'
      }
    }
  );
  return response.json();
};
```

### 2. æŸ¥è¯¢å¯¹æ¯”æ•°æ®
```javascript
// æŸ¥è¯¢æ—¥å¯¹æ¯”æ•°æ®
const getCompareData = async (moduleId, startTime, endTime) => {
  const response = await fetch('/jeecg-boot/energy/analysis/getCompareData', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      moduleId: moduleId,
      timeType: 'day',
      startTime: startTime,
      endTime: endTime,
      compareType: 'compare'
    })
  });
  return response.json();
};
```

### 3. å›¾è¡¨æ•°æ®å¤„ç†
```javascript
// å¤„ç†å›¾è¡¨æ•°æ®
const processChartData = (compareData) => {
  const { chartData } = compareData.result;
  
  return {
    xAxis: {
      type: 'category',
      data: chartData.categories
    },
    yAxis: {
      type: 'value',
      name: chartData.series[0].unit
    },
    series: chartData.series.map(s => ({
      name: s.name,
      type: 'line',
      data: s.data
    }))
  };
};
```

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–å»ºè®®

### 1. æ•°æ®åº“ç´¢å¼•
```sql
-- ä¸ºç»Ÿè®¡è¡¨æ·»åŠ ç´¢å¼•
CREATE INDEX idx_daycount_module_dt ON tb_ep_equ_energy_daycount(module_id, dt);
CREATE INDEX idx_monthcount_module_dt ON tb_ep_equ_energy_monthcount(module_id, dt);
CREATE INDEX idx_yearcount_module_dt ON tb_ep_equ_energy_yearcount(module_id, dt);

-- ä¸ºä»ªè¡¨è¡¨æ·»åŠ ç´¢å¼•
CREATE INDEX idx_module_org_energy ON tb_module(sys_org_code, energy_type);
```

### 2. ç¼“å­˜é…ç½®
```java
// åœ¨Serviceæ–¹æ³•ä¸Šæ·»åŠ ç¼“å­˜æ³¨è§£
@Cacheable(value = "energyTypes", key = "'all'")
public List<EnergyTypeVO> getEnergyTypes() {
    // ...
}
```

## ğŸ”„ æ•°æ®åŒæ­¥æ£€æŸ¥

ç¡®ä¿ç»Ÿè®¡æ•°æ®åŠæ—¶æ›´æ–°ï¼š
```sql
-- æ£€æŸ¥æœ€æ–°æ•°æ®æ—¶é—´
SELECT MAX(dt) as latest_day FROM tb_ep_equ_energy_daycount;
SELECT MAX(dt) as latest_month FROM tb_ep_equ_energy_monthcount;
SELECT MAX(dt) as latest_year FROM tb_ep_equ_energy_yearcount;
```

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚é‡é—®é¢˜ï¼Œè¯·æä¾›ï¼š
1. é”™è¯¯æ—¥å¿—
2. è¯·æ±‚å‚æ•°
3. æ•°æ®åº“æŸ¥è¯¢ç»“æœ
4. åº”ç”¨ç‰ˆæœ¬ä¿¡æ¯

---

**ç¥æ‚¨ä½¿ç”¨æ„‰å¿«ï¼** ğŸ‰
