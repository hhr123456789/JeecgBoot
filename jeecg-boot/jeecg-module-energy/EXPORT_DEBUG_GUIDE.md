# å®žæ—¶æ•°æ®å¯¼å‡ºExcelè°ƒè¯•æŒ‡å—

## ðŸ› å½“å‰é—®é¢˜

ç”¨æˆ·åé¦ˆå¯¼å‡ºExcelæ—¶é‡åˆ°ä»¥ä¸‹é—®é¢˜ï¼š
1. **æ•°æ®åªåˆ°13:30å°±ç»“æŸäº†**ï¼ˆåº”è¯¥åˆ°21:51ï¼‰
2. **æ‰€æœ‰æ•°æ®éƒ½æ˜¯ç©ºå€¼ï¼ˆæ˜¾ç¤ºä¸º"-"ï¼‰**

## ðŸ” é—®é¢˜æŽ’æŸ¥æ­¥éª¤

### 1. æ£€æŸ¥InfluxDBæŸ¥è¯¢ç»“æžœ

åœ¨å¯¼å‡ºåŠŸèƒ½ä¸­å·²æ·»åŠ è°ƒè¯•æ—¥å¿—ï¼ŒæŸ¥çœ‹åŽç«¯æ—¥å¿—ï¼š

```bash
# æŸ¥çœ‹å¯¼å‡ºç›¸å…³æ—¥å¿—
tail -f logs/jeecg-boot.log | grep "ðŸ“Š"
```

å…³é”®æ—¥å¿—ä¿¡æ¯ï¼š
- `ðŸ“Š InfluxDBæŸ¥è¯¢ç»“æžœæ•°é‡ï¼šX` - æŸ¥çœ‹æ˜¯å¦æœ‰æŸ¥è¯¢åˆ°æ•°æ®
- `ðŸ“Š æŸ¥è¯¢ç»“æžœç¤ºä¾‹` - æŸ¥çœ‹æŸ¥è¯¢åˆ°çš„æ•°æ®æ ¼å¼
- `ðŸ“Š ä»ŽæŸ¥è¯¢ç»“æžœä¸­æå–åˆ°çš„tagnameåˆ—è¡¨` - æŸ¥çœ‹tagnameæ˜¯å¦æ­£ç¡®
- `ðŸ“Š æ·»åŠ åˆ—` - æŸ¥çœ‹è¡¨å¤´æž„å»ºæ˜¯å¦æ­£ç¡®

### 2. éªŒè¯æŸ¥è¯¢å‚æ•°

ç¡®è®¤ä»¥ä¸‹å‚æ•°ï¼š
- **ä»ªè¡¨ID**: 1-4å·æ³¨å¡‘æœºçš„å®žé™…IDæ˜¯ä»€ä¹ˆï¼Ÿ
- **å‚æ•°ç¼–å·**: Aç›¸ç”µæµå¯¹åº”çš„å‚æ•°ç¼–å·æ˜¯1
- **æ—¶é—´èŒƒå›´**: 2025-07-23 00:00:00 è‡³ 2025-07-23 21:51:21
- **æŸ¥è¯¢é—´éš”**: 1ï¼ˆ15åˆ†é’Ÿï¼‰

### 3. æ£€æŸ¥ä»ªè¡¨IDæ˜ å°„

```sql
-- æŸ¥è¯¢æ³¨å¡‘æœºçš„å®žé™…ä»ªè¡¨ID
SELECT module_id, module_name, energy_type, isaction 
FROM tb_module 
WHERE module_name LIKE '%æ³¨å¡‘æœº%' 
AND isaction = 'Y';
```

### 4. æ£€æŸ¥InfluxDBæ•°æ®

```sql
-- åœ¨InfluxDBä¸­ç›´æŽ¥æŸ¥è¯¢æ•°æ®
SHOW DATABASES;
USE energy_data_202507;
SHOW MEASUREMENTS;

-- æŸ¥è¯¢ç‰¹å®šä»ªè¡¨çš„æ•°æ®
SELECT * FROM energy_data 
WHERE tagname =~ /^YJ0001_1202#.*/ 
AND time >= '2025-07-23T00:00:00Z' 
AND time <= '2025-07-23T13:51:21Z' 
LIMIT 10;
```

### 5. å¯¹æ¯”æŸ¥è¯¢æŽ¥å£å’Œå¯¼å‡ºæŽ¥å£

ä½¿ç”¨ç›¸åŒå‚æ•°åˆ†åˆ«è°ƒç”¨ï¼š
1. `/energy/monitor/getRealTimeMonitorData` - æŸ¥è¯¢æŽ¥å£
2. `/energy/monitor/exportRealTimeData` - å¯¼å‡ºæŽ¥å£

æŸ¥çœ‹ä¸¤ä¸ªæŽ¥å£çš„æŸ¥è¯¢ç»“æžœæ˜¯å¦ä¸€è‡´ã€‚

## ðŸ”§ å¯èƒ½çš„ä¿®å¤æ–¹æ¡ˆ

### æ–¹æ¡ˆ1ï¼šä»ªè¡¨IDä¸åŒ¹é…
å¦‚æžœä»ªè¡¨IDä¸æ­£ç¡®ï¼Œéœ€è¦ï¼š
1. ç¡®è®¤æ­£ç¡®çš„ä»ªè¡¨ID
2. æ›´æ–°å‰ç«¯ä¼ é€’çš„å‚æ•°

### æ–¹æ¡ˆ2ï¼štagnameæ ¼å¼é—®é¢˜
å¦‚æžœtagnameæ ¼å¼ä¸åŒ¹é…ï¼Œéœ€è¦ï¼š
1. æ£€æŸ¥InfluxDBä¸­å®žé™…çš„tagnameæ ¼å¼
2. è°ƒæ•´tagnameæž„å»ºé€»è¾‘

### æ–¹æ¡ˆ3ï¼šæ—¶é—´èŒƒå›´é—®é¢˜
å¦‚æžœæ—¶é—´èŒƒå›´æœ‰é—®é¢˜ï¼Œéœ€è¦ï¼š
1. æ£€æŸ¥æ—¶åŒºè½¬æ¢æ˜¯å¦æ­£ç¡®
2. ç¡®è®¤InfluxDBä¸­çš„æ•°æ®æ—¶é—´èŒƒå›´

### æ–¹æ¡ˆ4ï¼šæ•°æ®åº“è¿žæŽ¥é—®é¢˜
å¦‚æžœæ•°æ®åº“è¿žæŽ¥æœ‰é—®é¢˜ï¼Œéœ€è¦ï¼š
1. æ£€æŸ¥InfluxDBè¿žæŽ¥é…ç½®
2. ç¡®è®¤å¯¹åº”æœˆä»½çš„æ•°æ®åº“æ˜¯å¦å­˜åœ¨

## ðŸ“ æµ‹è¯•ç”¨ä¾‹

### æµ‹è¯•è¯·æ±‚å‚æ•°
```json
{
    "moduleIds": ["yj0001_1202", "yj0001_1203", "yj0001_1204", "yj0001_1205"],
    "parameters": [1],
    "startTime": "2025-07-23 00:00:00",
    "endTime": "2025-07-23 21:51:21",
    "interval": 1,
    "displayMode": 1,
    "fileName": "æ³¨å¡‘æœºAç›¸ç”µæµæ•°æ®å¯¼å‡º"
}
```

### é¢„æœŸç»“æžœ
- Excelæ–‡ä»¶åŒ…å«5åˆ—ï¼šæ—¶é—´ + 4ä¸ªä»ªè¡¨çš„Aç›¸ç”µæµæ•°æ®
- æ•°æ®æ—¶é—´èŒƒå›´ï¼š00:00 åˆ° 21:45ï¼ˆ15åˆ†é’Ÿé—´éš”ï¼‰
- æ¯ä¸ªæ—¶é—´ç‚¹éƒ½åº”è¯¥æœ‰å¯¹åº”çš„ç”µæµå€¼

## ðŸš€ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

1. **ç«‹å³æ‰§è¡Œ**ï¼šæŸ¥çœ‹åŽç«¯æ—¥å¿—ï¼Œç¡®è®¤æŸ¥è¯¢ç»“æžœ
2. **æ•°æ®éªŒè¯**ï¼šç¡®è®¤ä»ªè¡¨IDå’ŒInfluxDBä¸­çš„æ•°æ®
3. **å¯¹æ¯”æµ‹è¯•**ï¼šä½¿ç”¨æŸ¥è¯¢æŽ¥å£éªŒè¯æ•°æ®æ˜¯å¦å­˜åœ¨
4. **ä¿®å¤é—®é¢˜**ï¼šæ ¹æ®æ—¥å¿—ä¿¡æ¯å®šä½å¹¶ä¿®å¤é—®é¢˜
